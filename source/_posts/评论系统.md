---
title: 评论系统
date: 2023-07-02 00:19:51
tags:
---
[![](https://www.cnblogs.com/skins/custom/images/logo.gif)](https://www.cnblogs.com/fhhw/) 

[fhhw](https://www.cnblogs.com/fhhw/)
=====================================

*   [博客园](https://www.cnblogs.com/)
*   [首页](https://www.cnblogs.com/fhhw/)
*   [新随笔](https://i.cnblogs.com/EditPosts.aspx?opt=1)
*   [联系](https://msg.cnblogs.com/send/%E8%8B%8F%E6%9C%A8%E5%B7%9D)
*   [订阅](javascript:void(0))
*   [管理](https://i.cnblogs.com/)

[Hexo 评论系统](https://www.cnblogs.com/fhhw/p/17301034.html)
=========================================================

Hexo 博客系统是静态博客，本身无法支持评论等动态的功能，但是可以通过第三方的评论系统让 Hexo 博客支持评论功能。常见的评论系统包括：Valine、Disqus、Gitment、Giscus 等，本文主要介绍 Giscus 的使用。

Hexo 评论系统
=========

上一篇文章[博客搭建教程](https://www.cnblogs.com/fhhw/p/17296158.html)搭建了一个博客的基本框架，但是没有解决博客评论问题，本文填充一下这部分欠缺。

Hexo 博客系统是静态博客，本身无法支持评论等动态的功能，但是可以通过第三方的评论系统让 Hexo 博客支持评论功能。常见的评论系统包括：Valine、Disqus、Gitment、Giscus 等，本文主要介绍 Giscus 的使用。

giscus 简介
---------

giscus是由 [GitHub Discussions](https://docs.github.com/en/discussions) 驱动的评论系统。让访客借助 GitHub 在你的网站上留下评论和反应，该项目受 [utterances](https://github.com/utterance/utterances) 启发。包括以下特性：

*   开源；
*   无跟踪，无广告，永久免费；
*   无需数据库，全部数据均储存在 GitHub Discussions 中；
*   支持自定义主题；
*   支持多种语言；
*   高度可配置；
*   自动从 GitHub 拉取新评论与编辑；
*   可自建服务；

### 运作原理

giscus 加载时，会使用 [GitHub Discussions 搜索 API](https://docs.github.com/en/graphql/guides/using-the-graphql-api-for-discussions target=) 根据选定的映射方式（如 URL、`pathname`、`<title>` 等）来查找与当前页面关联的 discussion。如果找不到匹配的 discussion，giscus bot 就会在第一次有人留下评论或回应时自动创建一个 discussion。

要评论，访客必须按 GitHub OAuth 流程授权 [giscus app](https://github.com/apps/giscus) [代表他发帖](https://docs.github.com/en/developers/apps/identifying-and-authorizing-users-for-github-apps)。或者访客也可以直接在 GitHub Discussion 里评论。你可以在 GitHub 上管理评论。

在 Hexo 中配置 giscus
-----------------

**Step 1：**新建 Github 仓库，确保：

1.  此仓库是[公开的](https://docs.github.com/en/github/administering-a-repository/managing-repository-settings/setting-repository-visibility target=)，否则访客将无法查看 discussion。
2.  [giscus](https://github.com/apps/giscus) app 已安装否则访客将无法评论和回应。
3.  Discussions功能已[在你的仓库中启用](https://docs.github.com/en/github/administering-a-repository/managing-repository-settings/enabling-or-disabling-github-discussions-for-a-repository)。

**Step 2：**Hexo 配置

在你的 Hexo 博客目录中执行以下命令，安装 hexo-next-giscus 插件。

```bash

npm install hexo-next-giscus --save
```
然后在 Hexo 的 \_config.yml 配置文件添加如下内容：

```yaml

giscus:
  enable: true
  repo: \# Github repository name
  repo\_id: \# Github repository id
  category: \# Github discussion category
  category\_id: \# Github discussion category id
  \# Available values: pathname | url | title | og:title
  mapping: pathname
  \# Available values: 0 | 1 
  reactions\_enabled: 1
   \# Available values: 0 | 1 
  emit\_metadata: 1
  \# Available values: light | dark | dark\_high\_contrast | transparent\_dark | preferred-color-scheme
  theme: light
  \# Available values: en | zh-C
  lang: en
  \# Available value: anonymous
  crossorigin: anonymous
```
或者在主题的配置文件 \_config.themename.yml 中对应项添加即可，例如 butterfly 主题：

```yml

giscus:
 repo:    \# uername/repo\_name
 repo\_id: 
 category\_id: 
 theme:
  light: light
  dark: dark
 option:
```
`repo_id`是托管博客的代码仓库的一个标识值，`category`是该仓库Issues里面对应的分类（或者说是主题）。一个仓库默认具有下面几个分类：Announcements、General、Ideas、Q&A、Show and tell。这里我选择General作为评论的分类。最后的`category_id`类似`repo_id`也是对该分类的一个标识值。

如何快速的获取这些数据呢，可以通过GitHub官方的[GraphQL API Explorer](https://docs.github.com/en/graphql/overview/explorer)查询到。这里把查询所用的语句进行记录。

```highlighter- applescript

query {
  repository (name: "repo\_name", owner: "owner\_name")  {
    id
    discussionCategories (first: 5) {
      nodes {
        name
        id
      }
    }
  }
}
```
然后将查询数据填入对应项即可。

推荐使用**公告（announcements）**类型的分类，以确保新 discussion 只能由仓库维护者和 giscus 创建。


github - 如何找到自己的 Repo ID？
=========================

标签 [github](https://www.coder.work/blog?tag=github "github") [repository](https://www.coder.work/blog?tag=repository "repository")

虽然我绝对不是这个私有(private) repo 的所有者，但我一直将它用作学校项目组的一部分，老师在向他发送有关任何事情的电子邮件时只是询问 repo 的 ID。如果这对很多人来说是显而易见的，我很抱歉，但对于我的一生，我无法通过 github 或 google 找到任何明确的说明。我没有为我的 git 使用 GUI，严格通过 linux shell。  
  
如何找出当前 Repo 的 ID？

**最佳答案**

如果像我一样，您在 GitHub 存储库 ID 之后(如 - 识别存储库的编号 - 不是它的名称)，那么我通过 GitHub 存储库主页上的元数据元素找到了一种简单的方法:  

*   查看页面源代码(例如在 Chrome 或 Firefox 中右键 > 查看页面源代码)
*   搜索页面源并查找 `octolytics-dimension-repository_id` 。您应该找到如下所示的内容:  
    `<meta content="123456789" name="octolytics-dimension-repository_id" />`
  
[![](https://mp-6fc29f3f-14dc-4d29-99e1-a8caab6a2c40.cdn.bspapp.com/博客图片/giscus/resp_id.png)](https://mp-6fc29f3f-14dc-4d29-99e1-a8caab6a2c40.cdn.bspapp.com/博客图片/giscus/resp_id.png)

github - 如何找到自己的 Repo ID？
=========================

[![](https://mp-6fc29f3f-14dc-4d29-99e1-a8caab6a2c40.cdn.bspapp.com/博客图片/giscus/cate1.png)](https://mp-6fc29f3f-14dc-4d29-99e1-a8caab6a2c40.cdn.bspapp.com/博客图片/giscus/cate1.png)
[![](https://mp-6fc29f3f-14dc-4d29-99e1-a8caab6a2c40.cdn.bspapp.com/博客图片/giscus/cate2.png)](https://mp-6fc29f3f-14dc-4d29-99e1-a8caab6a2c40.cdn.bspapp.com/博客图片/giscus/cate2.png)
[![](https://mp-6fc29f3f-14dc-4d29-99e1-a8caab6a2c40.cdn.bspapp.com/博客图片/giscus/cate3.png)](https://mp-6fc29f3f-14dc-4d29-99e1-a8caab6a2c40.cdn.bspapp.com/博客图片/giscus/cate3.png)


